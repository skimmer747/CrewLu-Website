<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Import All - CrewLu App</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">CrewLu</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">Home</a></li>
							<li><a href="features.html">Features</a></li>
							<li class="active"><a href="import-all.html">Import All</a></li>
							<li><a href="privacy-policy.html">Privacy Policy</a></li>
						</ul>
						<ul class="icons">
							<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="#" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Import All Content -->
							<section class="post">
								<header class="major">
									<h1>Import All</h1>
									<p>Quickly import your schedule into the CrewLu app by generating a QR code.<br />
									Simply paste your schedule text below, then scan the QR code with your iOS device.</p>
								</header>

								<!-- Instructions -->
								<div class="box">
									<h3>How to Use:</h3>
									<ol>
										<li>Paste your schedule text into the text area below</li>
										<li>A QR code will automatically be generated</li>
										<li>Open the CrewLu app on your iOS device</li>
										<li>Use the app's QR scanner to scan the code</li>
										<li>Your schedule will be imported instantly</li>
									</ol>
								</div>

								<!-- Schedule Input -->
								<h2>Schedule Text</h2>
								<p>Paste your schedule information below:</p>
								
								<div class="fields">
									<div class="field">
										<textarea name="schedule" id="schedule" placeholder="Paste your schedule text here..." rows="12" style="min-height: 300px; font-family: monospace; font-size: 14px;"></textarea>
									</div>
								</div>

								<!-- QR Code Display -->
								<h2>QR Code</h2>
								<p>Scan this QR code with the CrewLu app:</p>
								
								<!-- QR Code Options -->
								<div class="row">
									<div class="col-4 col-12-small">
										<label for="qr-size">QR Code Size:</label>
										<select name="qr-size" id="qr-size">
											<option value="200">200x200 (Recommended)</option>
											<option value="256">256x256</option>
											<option value="300">300x300</option>
											<option value="128">128x128 (Small)</option>
										</select>
									</div>
									<div class="col-4 col-12-small">
										<label for="error-level">Error Correction:</label>
										<select name="error-level" id="error-level">
											<option value="M">Medium (Recommended - Best Balance)</option>
											<option value="Q">Quartile (25% correction)</option>
											<option value="H">High (30% correction - Less Data)</option>
											<option value="L">Low (More Data Capacity)</option>
										</select>
									</div>
									<div class="col-4 col-12-small">
										<label for="compression">Text Compression:</label>
										<select name="compression" id="compression">
											<option value="never">Disabled (iOS App Not Updated)</option>
											<option value="auto">Auto (When iOS App Updated)</option>
											<option value="always">Always Compress</option>
										</select>
									</div>
								</div>
								
								<!-- Data Size Info -->
								<div id="size-info" style="margin: 10px 0; padding: 10px; background-color: #f0f0f0; border-radius: 4px; font-size: 14px; display: none;">
									<div id="size-display"></div>
								</div>
								<br />
								
								<div id="qrcode-container" style="text-align: center; padding: 20px; background-color: #f9f9f9; border-radius: 4px; margin: 20px 0;">
									<div id="qrcode" style="display: inline-block;"></div>
									<div id="qr-message" style="margin-top: 15px; color: #666; font-style: italic;">Enter text above to generate QR code</div>
								</div>

								<!-- Additional Info -->
								<div class="box">
									<h3>Scanning Tips:</h3>
									<ul>
										<li><strong>Test First:</strong> Try scanning with your iPhone's built-in Camera app to verify the QR code works</li>
										<li><strong>Distance:</strong> Hold your device 6-12 inches away from the screen</li>
										<li><strong>Lighting:</strong> Ensure good lighting - avoid glare on the screen</li>
										<li><strong>Focus:</strong> Keep the QR code centered and wait for the camera to focus</li>
										<li><strong>Size:</strong> If scanning fails, try different QR code sizes from the dropdown above</li>
										<li><strong>Large Text:</strong> Very large amounts of text create complex QR codes that may be harder to scan</li>
									</ul>
									<p><strong>Troubleshooting:</strong> If your app won't scan but the Camera app can read it, the issue may be with your app's QR scanner implementation.</p>
								</div>
								
								<div class="box">
									<h3>‚ö†Ô∏è iOS App Update Required for Compression</h3>
									<p><strong>Current Status:</strong> Compression is <strong>disabled by default</strong> because your iOS app needs an update to handle compressed data.</p>
									
									<details>
										<summary><strong>üì± Click here for iOS Swift code to add to your app</strong></summary>
										<div style="background: #f8f8f8; padding: 15px; margin: 10px 0; border-left: 4px solid #3498db;">
											<h4>Add this Swift code to handle compressed QR data:</h4>
											<pre style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 4px; font-size: 12px; overflow-x: auto;"><code>import Foundation
import Compression

func processQRData(_ qrString: String) -> String {
    // Check if data is compressed
    if qrString.hasPrefix("CREWLU_COMPRESSED:") {
        let base64Data = String(qrString.dropFirst(17)) // Remove "CREWLU_COMPRESSED:" prefix
        
        // Decode base64
        guard let compressedData = Data(base64Encoded: base64Data) else {
            print("Failed to decode base64 data")
            return qrString // Return original if decoding fails
        }
        
        // Decompress gzip data
        guard let decompressedData = try? decompressGzip(compressedData) else {
            print("Failed to decompress data")
            return qrString // Return original if decompression fails
        }
        
        // Convert back to string
        guard let decompressedString = String(data: decompressedData, encoding: .utf8) else {
            print("Failed to convert decompressed data to string")
            return qrString
        }
        
        return decompressedString
    } else {
        // Not compressed, return as-is
        return qrString
    }
}

func decompressGzip(_ data: Data) throws -> Data {
    return try data.withUnsafeBytes { bytes in
        let buffer = UnsafeBufferPointer<UInt8>(
            start: bytes.bindMemory(to: UInt8.self).baseAddress,
            count: data.count
        )
        let destinationBuffer = UnsafeMutablePointer<UInt8>.allocate(capacity: data.count * 4)
        defer { destinationBuffer.deallocate() }
        
        let decompressedSize = compression_decode_buffer(
            destinationBuffer, data.count * 4,
            buffer.baseAddress!, data.count,
            nil, COMPRESSION_ZLIB
        )
        
        guard decompressedSize > 0 else {
            throw DecompressionError.failed
        }
        
        return Data(bytes: destinationBuffer, count: decompressedSize)
    }
}

enum DecompressionError: Error {
    case failed
}</code></pre>
											<h4>How to integrate:</h4>
											<ol style="font-size: 14px;">
												<li>Add the above code to your iOS app</li>
												<li>In your QR scanner result handler, call: <code>let processedText = processQRData(scannedQRString)</code></li>
												<li>Use <code>processedText</code> instead of the raw QR string</li>
												<li>The code automatically handles both compressed and uncompressed data</li>
											</ol>
										</div>
									</details>
									
									<h3>Text Compression Settings:</h3>
									<ul>
										<li><strong>Disabled (Current):</strong> No compression - works with current iOS app but limited data size</li>
										<li><strong>Auto (After Update):</strong> Automatically compresses large text (>1500 bytes) to fit in QR codes</li>
										<li><strong>Always Compress:</strong> All text is compressed - great for very large schedules</li>
										<li><strong>Compression Benefits:</strong> Typically reduces text size by 50-70%, enabling much larger schedules</li>
									</ul>
								</div>
									
									<h3>Error Correction Levels:</h3>
									<ul>
										<li><strong>Medium (Recommended):</strong> 15% error correction - Best balance of iOS compatibility and data capacity</li>
										<li><strong>High:</strong> 30% error correction - Most damage resistant but holds less text data</li>
										<li><strong>Low:</strong> 7% error correction - Maximum data capacity but less damage resistant</li>
										<li><strong>Auto-Fallback:</strong> If your preferred level can't fit the text, a lower level will be used automatically</li>
									</ul>
									
									<h3>Privacy & Technical Info:</h3>
									<ul>
										<li>The QR code updates automatically as you type or paste text</li>
										<li>All processing happens locally in your browser - no data is sent to our servers</li>
										<li>Compressed data includes a prefix so your iOS app knows to decompress it</li>
										<li>Large text may automatically use lower error correction for compatibility</li>
									</ul>
								</div>

								<!-- Call to Action -->
								<hr />
								<h2>Don't Have the CrewLu App Yet?</h2>
								<p>Download CrewLu from the App Store to start managing your crew schedules efficiently.</p>
								<ul class="actions special">
									<li><a href="https://apps.apple.com" class="button large primary">Download from App Store</a></li>
								</ul>
							</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<section>
							<h3>Get in Touch</h3>
							<form method="post" action="#">
								<div class="fields">
									<div class="field">
										<label for="name">Name</label>
										<input type="text" name="name" id="name" />
									</div>
									<div class="field">
										<label for="email">Email</label>
										<input type="text" name="email" id="email" />
									</div>
									<div class="field">
										<label for="message">Message</label>
										<textarea name="message" id="message" rows="3"></textarea>
									</div>
								</div>
								<ul class="actions">
									<li><input type="submit" value="Send Message" /></li>
								</ul>
							</form>
						</section>
						<section class="split contact">
							<section class="alt">
								<h3>Download</h3>
								<p><a href="https://apps.apple.com" class="button">App Store</a></p>
							</section>
							<section>
								<h3>Support</h3>
								<p><a href="mailto:skimmer747+crewlu@gmail.com">skimmer747+crewlu@gmail.com</a></p>
							</section>
							<section>
								<h3>Legal</h3>
								<p><a href="privacy-policy.html">Privacy Policy</a><br />
								<a href="#">Terms of Service</a></p>
							</section>
							<section>
								<h3>Follow Us</h3>
								<ul class="icons alt">
									<li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
									<li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
									<li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
									<li><a href="#" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
								</ul>
							</section>
						</section>
					</footer>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; 2024 CrewLu. All rights reserved.</li><li>Available on <a href="https://apps.apple.com">iOS App Store</a></li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			
			<!-- QR Code Library -->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
			
			<!-- Text Compression Library -->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
			
			<!-- QR Code Functionality -->
			<script>
				$(document).ready(function() {
					var qr = null;
					var qrCodeDiv = document.getElementById("qrcode");
					var messageDiv = document.getElementById("qr-message");
					var scheduleTextarea = document.getElementById("schedule");
					var sizeInfoDiv = document.getElementById("size-info");
					var sizeDisplayDiv = document.getElementById("size-display");
					
					function compressText(text) {
						try {
							// Convert string to Uint8Array
							var textBytes = new TextEncoder().encode(text);
							// Compress using gzip
							var compressed = pako.gzip(textBytes);
							// Convert to base64 for QR code compatibility
							var base64 = btoa(String.fromCharCode.apply(null, compressed));
							// Add compression prefix so iOS app knows to decompress
							return "CREWLU_COMPRESSED:" + base64;
						} catch (error) {
							console.error('Compression failed:', error);
							return text; // Fallback to original text
						}
					}
					
					function shouldCompress(text, compressionSetting) {
						var textSize = new TextEncoder().encode(text).length;
						
						if (compressionSetting === "always") return true;
						if (compressionSetting === "never") return false;
						if (compressionSetting === "auto") {
							// Auto-compress if text is larger than 1500 bytes (leaves room for QR capacity)
							return textSize > 1500;
						}
						
						return false;
					}
					
					function updateSizeInfo(originalText, finalText, wasCompressed) {
						var originalSize = new TextEncoder().encode(originalText).length;
						var finalSize = new TextEncoder().encode(finalText).length;
						
						if (originalText.trim() === "") {
							sizeInfoDiv.style.display = "none";
							return;
						}
						
						var sizeText = "";
						if (wasCompressed) {
							var savings = originalSize - finalSize;
							var percentSavings = Math.round((savings / originalSize) * 100);
							sizeText = `<strong>Compression:</strong> ${originalSize} bytes ‚Üí ${finalSize} bytes (${percentSavings}% reduction)`;
							
							if (finalSize > 2800) {
								sizeText += ` <span style="color: #e67e22;">‚ö†Ô∏è Still very large - may have scanning issues</span>`;
							} else if (finalSize > 2000) {
								sizeText += ` <span style="color: #f39c12;">‚ö†Ô∏è Large but should work</span>`;
							} else {
								sizeText += ` <span style="color: #27ae60;">‚úÖ Good size for QR code</span>`;
							}
						} else {
							sizeText = `<strong>Size:</strong> ${originalSize} bytes (uncompressed)`;
							
							if (originalSize > 2800) {
								sizeText += ` <span style="color: #e74c3c;">‚ö†Ô∏è Too large - enable compression</span>`;
							} else if (originalSize > 2000) {
								sizeText += ` <span style="color: #e67e22;">‚ö†Ô∏è Large - consider compression</span>`;
							} else {
								sizeText += ` <span style="color: #27ae60;">‚úÖ Good size</span>`;
							}
						}
						
						sizeDisplayDiv.innerHTML = sizeText;
						sizeInfoDiv.style.display = "block";
					}
					
					function generateQRCode(text) {
						// Clear existing QR code
						qrCodeDiv.innerHTML = "";
						
						if (text.trim() === "") {
							messageDiv.textContent = "Enter text above to generate QR code";
							messageDiv.style.display = "block";
							sizeInfoDiv.style.display = "none";
							return;
						}
						
						// Get current settings
						var sizeSelect = document.getElementById("qr-size");
						var errorSelect = document.getElementById("error-level");
						var compressionSelect = document.getElementById("compression");
						var size = parseInt(sizeSelect ? sizeSelect.value : 200);
						var preferredErrorLevel = errorSelect ? errorSelect.value : "M";
						var compressionSetting = compressionSelect ? compressionSelect.value : "never";
						
						// Determine if we should compress the text
						var useCompression = shouldCompress(text, compressionSetting);
						var finalText = useCompression ? compressText(text) : text;
						
						// Update size information
						updateSizeInfo(text, finalText, useCompression);
						
						// Hide message initially
						messageDiv.style.display = "none";
						
						// Try generating QR code with fallback error correction levels
						var errorLevels = [preferredErrorLevel];
						// Add fallback levels if not already included
						if (preferredErrorLevel !== "M") errorLevels.push("M");
						if (preferredErrorLevel !== "L") errorLevels.push("L");
						
						var qrGenerated = false;
						var usedErrorLevel = null;
						
						for (var i = 0; i < errorLevels.length; i++) {
							try {
								var currentLevel = errorLevels[i];
								qr = new QRCode(qrCodeDiv, {
									text: finalText,
									width: size,
									height: size,
									colorDark: "#000000",
									colorLight: "#ffffff",
									correctLevel: QRCode.CorrectLevel[currentLevel]
								});
								qrGenerated = true;
								usedErrorLevel = currentLevel;
								break;
							} catch (error) {
								// Clear any partial QR code and try next error level
								qrCodeDiv.innerHTML = "";
								continue;
							}
						}
						
						// Show feedback about QR generation
						if (qrGenerated) {
							var feedbackMessage = "";
							var feedbackColor = "#27ae60"; // Green
							
							// Add compression info to feedback
							if (useCompression) {
								feedbackMessage += "‚úÖ QR Code generated with compressed data. ";
							}
							
							// Add error correction fallback info
							if (usedErrorLevel !== preferredErrorLevel) {
								var levelNames = {"L": "Low", "M": "Medium", "Q": "Quartile", "H": "High"};
								feedbackMessage += "Using " + levelNames[usedErrorLevel] + " error correction (" + levelNames[preferredErrorLevel] + " had insufficient capacity).";
								feedbackColor = "#e67e22"; // Orange
							} else if (!useCompression && usedErrorLevel === preferredErrorLevel) {
								messageDiv.style.display = "none";
								return;
							}
							
							if (feedbackMessage) {
								messageDiv.textContent = feedbackMessage;
								messageDiv.style.display = "block";
								messageDiv.style.color = feedbackColor;
							} else {
								messageDiv.style.display = "none";
							}
						} else {
							var errorMessage = "Error: Text too large for QR code even with compression. ";
							if (compressionSetting === "never") {
								errorMessage += "Try enabling compression or reduce the text amount.";
							} else {
								errorMessage += "Please reduce the amount of text.";
							}
							messageDiv.textContent = errorMessage;
							messageDiv.style.display = "block";
							messageDiv.style.color = "#e74c3c";
						}
					}
					
					// Generate QR code on input change
					scheduleTextarea.addEventListener('input', function() {
						generateQRCode(this.value);
					});
					
					// Also trigger on paste event
					scheduleTextarea.addEventListener('paste', function() {
						// Use setTimeout to wait for paste content to be processed
						setTimeout(function() {
							generateQRCode(scheduleTextarea.value);
						}, 10);
					});
					
					// Add event listeners for QR code options
					document.getElementById("qr-size").addEventListener('change', function() {
						generateQRCode(scheduleTextarea.value);
					});
					
					document.getElementById("error-level").addEventListener('change', function() {
						generateQRCode(scheduleTextarea.value);
					});
					
					document.getElementById("compression").addEventListener('change', function() {
						generateQRCode(scheduleTextarea.value);
					});
				});
			</script>

	</body>
</html>